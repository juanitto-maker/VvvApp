<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VvvebJs Debug</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        .card { background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #007bff; }
        .success { border-color: #28a745; background: #d4edda; }
        .error { border-color: #dc3545; background: #f8d7da; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .file-list { background: #fff; padding: 15px; border-radius: 4px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>üîß VvvebJs Deployment Debug</h1>
    
    <div class="card">
        <h3>Current Status</h3>
        <p><strong>Domain:</strong> <span id="current-url"></span></p>
        <p><strong>API Status:</strong> <span id="api-status">Testing...</span></p>
        <p><strong>Files Found:</strong> <span id="files-found">Checking...</span></p>
    </div>

    <div class="card">
        <h3>Quick Actions</h3>
        <button onclick="testAPI()">Test API</button>
        <button onclick="listFiles()">Check Files</button>
        <button onclick="window.open('/test-api.html')">API Test Page</button>
    </div>

    <div id="results"></div>

    <script>
        // Show current URL
        document.getElementById('current-url').textContent = window.location.href;

        async function testAPI() {
            const status = document.getElementById('api-status');
            try {
                const response = await fetch('/api/save.js');
                const data = await response.json();
                status.innerHTML = response.ok ? '‚úÖ Working' : '‚ùå Failed';
            } catch (error) {
                status.innerHTML = '‚ùå Error: ' + error.message;
            }
        }

        async function listFiles() {
            const filesToCheck = [
                'editor.html',
                'css/editor.css', 
                'js/bootstrap.min.js',
                'js/popper.min.js',
                'js/mobile-drag-drop.js',
                'libs/builder/builder.js',
                'libs/builder/components-bootstrap5.js',
                'demo/landing/index.html',
                'demo/landing/sections/sections.js'
            ];

            const results = document.getElementById('results');
            results.innerHTML = '<div class="card"><h3>File Check Results</h3><div id="file-results">Checking files...</div></div>';
            
            let found = 0;
            let total = filesToCheck.length;
            let html = '<div class="file-list">';
            
            for (const file of filesToCheck) {
                try {
                    const response = await fetch(file, { method: 'HEAD' });
                    const status = response.ok ? '‚úÖ' : '‚ùå';
                    const color = response.ok ? 'green' : 'red';
                    if (response.ok) found++;
                    html += `<div style="color: ${color};">${status} ${file}</div>`;
                } catch (error) {
                    html += `<div style="color: red;">‚ùå ${file} (Error: ${error.message})</div>`;
                }
            }
            
            html += '</div>';
            
            document.getElementById('file-results').innerHTML = html;
            document.getElementById('files-found').textContent = `${found}/${total}`;
            
            // Show recommendations
            if (found === 0) {
                results.innerHTML += `
                    <div class="card error">
                        <h3>‚ö†Ô∏è No Files Found</h3>
                        <p>It looks like your main VvvebJs files are not uploaded or are in a different location.</p>
                        <p><strong>Next Steps:</strong></p>
                        <ul>
                            <li>Check if files are uploaded to your Vercel project</li>
                            <li>Verify file paths and structure</li>
                            <li>Make sure files are in the root directory</li>
                        </ul>
                    </div>`;
            } else if (found < total) {
                results.innerHTML += `
                    <div class="card error">
                        <h3>‚ö†Ô∏è Some Files Missing</h3>
                        <p>Found ${found} out of ${total} files. Upload the missing files to complete your setup.</p>
                    </div>`;
            } else {
                results.innerHTML += `
                    <div class="card success">
                        <h3>‚úÖ All Files Found!</h3>
                        <p>Great! All core files are present. Try accessing the editor now.</p>
                        <button onclick="window.open('/editor.html')">Open Editor</button>
                    </div>`;
            }
        }

        // Auto-run tests
        window.addEventListener('load', () => {
            testAPI();
            setTimeout(listFiles, 1000);
        });
    </script>
</body>
</html>
